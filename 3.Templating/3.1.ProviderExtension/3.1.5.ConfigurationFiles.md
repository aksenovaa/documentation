3.1.5 Файлы настройки расширения поставщика
===========================================

![FluidTYPO3 File contexts, Configuration](../Images/FileContext/Configuration.svgz)

Fluid Powered TYPO3 и само ядро TYPO3 имеет несколько возможностей добавления TypoScript для настройки шаблонов своих расширений. Какой использовать — решать вам, но у каждого есть недостатки и достоинства, о которых нужно знать.

По правилам, файлы TypoScript должны находиться в `EXT:myextensionkey/Configuration/TypoScript` в виде пары `setup.txt` и
`constants.txt`. Можно добавить несколько подпапок и зарегистрировать каждую из них индивидуально, например, разбив TypoScript на основную настройки и одну или несколько дополнительных — стратегия, использующаяся во множестве популярных расширениях TYPO3. При такой настройке файлы основной настройки могут находиться в `EXT:myextensionkey/Configuration/TypoScript`, а дополнительные настройки в `EXT:myextensionkey/Configuration/TypoScript/ExtendedSettings`; и возможно их индивидуальное подключение в TYPO3.

## Параметры для подключения TypoScript

Следующие параметры официально рекомендованы командой разработчиков Fluid Powered TYPO3, есть и другие возможности, но они не
рекомендуются и здесь не упомянуты.

### Возможность 1: стандартный статичный TypoScript

При этом требуется вручную включить свою настройку в настройку сайта. Обычно для при этом выбирается нужный шаблон на вкладке
"Включения/Includes" при редактировании записи "Шаблон TypoScript".

```php
// ext_tables.php
\TYPO3\CMS\Core\Utility\ExtensionManagementUtility::addStaticFile($_EXTKEY, 'Configuration/TypoScript', 'My settings');
```

За:

* Поддержка констант — идеально для редакторов сайта и просто в использовании.
* Не обязательно — идеально для много доменных сайтов, использующих наборы шаблонов.

Против:

* Требуется подключение вручную — для полностью автоматической установки можно найти лучшие варианты.

### Возможность 2: минимальная, всегда включаемая настройка по умолчанию

Всегда подключаемая при загрузке расширения настройка.

```php
// ext_localconf.php
\TYPO3\CMS\Core\Utility\ExtensionManagementUtility::addTypoScript($_EXTKEY, 'setup', '
	plugin.tx_myextensionkey.view {
		templateRootPath = EXT:flux/Resources/Private/Templates/
		partialRootPath = EXT:flux/Resources/Private/Partials/
		layoutRootPath = EXT:flux/Resources/Private/Layouts/
	}
');

```

За:

* Автоматическое подключение — не нужно вручную подключать настройки в запись "шаблоноа TypoScript".
* Очень эффективно — простая конкатенация строк.

Против:

* Нет поддержки констант, если только не воспользоваться соответствующим блоком `addTypoScript($_EXTKEY, 'constants', '...');`.
* Настройки TypoScript находятся внутри контекста PHP, где разделение интересов желает лучшего.
* Единственный способ отключения TypoScript — его сброс/unset, что не эффективно.

### Возможность 3: уловка/hook во Flux для добавления статичной настройки

Автоматически в всегда включаемая настройка, но симулирующая вручную подключаемые статичные шаблоны TypoScript.

```php
// ext_localconf.php
\FluidTYPO3\Flux\Core::addStaticTypoScript('EXT:myextensionkey/Configuration/TypoScript/');
```

За:

* Автоматическое включение во все шаблоны.
* Чёткое разделение настроек/setup и констант/constants и размещение их в соответствующих файлах.
* Симуляция ручного подключения статических файлов (которые загружаются после, например, возможности 2, выше, но перед вручную
добавленными настройками).

Против:

* (Незначительно) менее эффективны, чем другие способы.
* Как и в варианте 2, единственный способ отключения — сброс/unset, после установки.
