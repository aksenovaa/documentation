1.3 Использование файла шаблон/Template
=======================

![FluidTYPO3 File contexts, templates](../Images/FileContext/Templates.svgz)

Должно быть предельно понятно, что мы _используем правила Extbase для размещения папок и файлов настроек и шаблонов_, и что _расширение поставщик — это обычное расширение TYPO3 с некой предопределённой файловой структурой_. А способ использования каждой папки обычно зависит от типа создаваемого расширения постащика, и руководства по функционалу всегда начинаются с объяснения того, какие папки и файлы здесь задействованы.

Файлы `ext_localconf.php` и `ext_tables.php` содержат различные вызовы к Flux для регистрации типов шаблонов Flux, используемых в расширении проводнике, наряду с другой необходимой настройкой, например, дополнительными полями TCA для `tt_content`.
Папка `Resources/Private` содержит структуру для шаблона и языковых файлов, сами шаблоны разбиты на подпапки по названию контроллера, который будет заниматься их обработкой (например, во `fluidpages` контроллер называется `PageController`, а папка называется `Page`, во `fluidcontent` контроллер называется `Content` и так далее). Макеты/Layouts и Шаблонные части/Partials поддерживаются как обычно. И наконец, директория `Configuration` содержит TypoScript, который становиться доступным для подключения интеграторами в TYPO3 после установки расширения.

### Что должены содержать файлы шаблонов?

Фактическое содержимое файлов-шаблонов зависит от функционала, для которого они создавались, но имеется и общие правила, о которых можно прочитать в главе [Концепция шаблонов](../3.Templating/3.2.CreatingTemplateFiles/3.2.1.CommonFileStructure.md) этой документации. Следуя стандартным правилам всегда приводит к рабочим, выбираемым (пока ещё по минимуму) шаблонам, а что ещё, в дополнение к стандартным элементам, должен содержать шаблон зависит от определённой функции и документируется в ней.

Обязательное форматирование необходимо лишь для файлов в папке `Templates`, то есть, в папках
Layouts и Partials может находится любое содержимое, но в Templates необходимо размещать специфичную для Flux информацию.

### Чем шаблон Flux отличается от обычного шаблона Fluid?

Используемый Flux файл шаблона точно такой же, как и обычный шаблон fluid, но имеет дополнительные требования:

1. Должна присутствовать область именования/namespace `{namespace flux=FluidTYPO3\Flux\ViewHelpers}`.
2. Должен присутствовать раздел `Configuration`, созданный при помощи `f:section`.

Внутри раздела `Configuration` (или с другим названием, если вы не следуете общим правилам) необходимо поместить тег `flux:form`, содержащий хотя бы атрибут `id`, который должен иметь значение в формате `lowerCamelCase`, например, `specialImage`.

Имеется необязательный раздел, который можно добавить, если шаблон Flux будет использоваться с таблицей `tt_content`, это раздел `Preview` (опять же, добавляемый через `f:section`), который может содержать вывод HTML в модуле Страница/Page в TYPO3 при просмотре записи. Это автоматически срабатывает для дополнений Flux (которые включают, но не ограничиваются, элементами из `fluidcontent`).

И последнее правил, которого *необходимо* придерживаться, но которое *можно* при необходимости проигнорировать, название раздела, содержащего файктический вывод для сайта, `Main` — этот раздел выводится из использумого макета/Layout, конечно, можно выбрать и другое название, если это имеет значение. Просто использование названия `Main` сделает предназначение этого раздела понятным для других.

Максимально урезанный пример шаблона (пример: `fluidcontent` элемент шаблон):

```xml
{namespace flux=FluidTYPO3\Flux\ViewHelpers}
<f:layout name="Content" />
<f:section name="Configuration">
    <flux:form id="myContentElement" />
</f:section>
<f:section name="Main">
    My content element
</f:section>
```

Как видите, этот пример удовлетворяет лишь двум основным требованиям и использует соглашения об именовании для макета/Layout, которые мы опишем в следующей главе. При добавлении в набор шаблонов `fluidcontent`, название этого типа элементов будет "myContentElement", и в нём не будет никаких дополнительных полей, значков, понятных меток, а при выводе он будет отображать простой текст "My content element" без каких-либо тегов HTML.

### Альтернатива шаблонам

Обратите внимание, что существует альтернатива размещению формы с полями внутри шаблона. Используя свой класс поставщика/Provider, можно возвращать объекты PHP непосредственно из методов `getForm` и `getGrid`. Поставщик/Provider наследует эти два метода от класса Flux `AbstractProvider`, и, в наследуемом от Flux коде, Provider будет по умолчанию искать внутри файла шаблона экземпляры Form и Grid. При переназначении любого их указанных методов, соответственно, чтения Form и Grid, не потребует чтения файла шаблона.

Всё это означает, что, если вернуть родные объекты PHP из Provider для экземпляров Form *и* Grid, то в самом файле шаблона нет больше необходимости включать раздел `Configuration` и любые определения `flux:form`. Provider даже может возвращать непосредственно HTML предпросмотр, что, при реализации, позволяет пропустить и раздел `Preview`. Конечно, Previews применимо лишь к записям `tt_content`, как уже было сказано.

> Осторожно! Некоторый функционал Fluid Powered TYPO3 требует, чтобы файлы шаблона содержали раздел `Configuration` и тег `flux:form`. Хотя возможно обойти и это требование посредством создания своего Provider, занимающего место включаемого вместе с расширением провайдера, например `fluidcontent` ContentProvider, `fluidpages` PageProvider и так далее. Заменяя провайдера можно изменить почти все аспекты работы определённого функционала в соответствие с логикой работы сайта. Мы разработали API так, чтобы все функции, вроде `fluidcontent`, были доступны через API, и через своего провайдера/Providers, то есть, все, что могут делать эти расширения, можете сделать и вы.

Для сведений о параметрах в этой области — как создавать свой класс Provider, можно обратиться к 
[главе класс Provider](../4.AdvancedProviders/4.2.CustomFluxProviders/4.2.1.UseCasesProviders.md).

Далее: [Глава 1.4: Использование раздела Configuration](1.4.ConfigurationUsage.md).
